{
  "hooks": {
    "UserPromptSubmit": [
      {
        "matcher": "*",
        "hooks": [
          {
            "type": "prompt",
            "prompt": "Check if RAG mode is enabled by reading ${CLAUDE_PLUGIN_ROOT}/code-crib.local.md.\n\nIF auto_rag.enabled is TRUE:\n1. Extract the user's question/request from their message\n2. Search the knowledge stash using vector search (same as /grab)\n3. If relevant results found (relevance > 0.7), prepend context:\n   'ðŸ“š [RAG Context] Found relevant knowledge:\\n[summary of top 3 results]\\n---\\n'\n4. Continue processing the user's request with this context\n\nIF auto_rag.enabled is FALSE or file doesn't exist:\n- Do nothing, let the message be processed normally\n\nIMPORTANT: This should be fast and silent. Don't announce RAG lookups unless results are found."
          }
        ]
      }
    ],
    "Stop": [
      {
        "matcher": "*",
        "hooks": [
          {
            "type": "prompt",
            "prompt": "Analyze this session for documentation-worthy work and auto-save if significant:\n\n## Significance Criteria (check any):\n- Code files were modified (Edit/Write tool used)\n- Bug was diagnosed and fixed\n- New feature was implemented\n- Architecture decision was made or documented\n\n## Auto-Save Rules:\n\n**IF significant work detected:**\n1. Automatically invoke the /stash command (or /save)\n2. Let the documenter agent generate the document\n3. Report to user: 'Session auto-documented: [title]'\n\n**IF no significant work (skip silently):**\n- Only file reads occurred\n- Only questions/answers without code changes\n- Only exploration/analysis without conclusions\n\n## Threshold Examples:\n| Session Activity | Action |\n|------------------|--------|\n| Fixed a bug with code edit | AUTO-SAVE |\n| Implemented new feature | AUTO-SAVE |\n| Refactored code structure | AUTO-SAVE |\n| Just read files for context | SKIP |\n| Asked questions, got explanations | SKIP |\n| Explored codebase without changes | SKIP |\n\nBe intelligent: if the user explicitly said 'fixed', 'solved', 'implemented', 'completed' - that's significant work worth documenting."
          }
        ]
      }
    ]
  }
}
